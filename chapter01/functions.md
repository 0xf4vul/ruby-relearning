# 函数

Ruby 中的函数 (function) 的本质其实是方法 (method)。关于这两者的差异，我们会在《第四周：面向对象再入门》中再详述。我们在这一章节中还是作为函数来处理。

## 什么是函数？

理解什么是程序中的函数，我们先理解什么是数学中的函数。在小学和初中中学习的函数通常是比较狭隘的，往往把函数和表达式画上等号。但站在集合论的角度，我们可以更好理解函数的本质。我们把定义域和值域看成两个集合，函数就是定义域和值域的对应关系。

如果我们用比较粗糙的观点来看，函数 $$ f $$ 就是一个黑盒 (black box)。当你扔进去一个定义域里的 $$ x $$，函数就会返回一个经过函数处理的结果 $$ y $$，即 $$ y = f(x) $$。程序中的函数也是这样一个东西，但是和数学中的函数也有一些细微差异。

目的上来说，程序中的函数和数学上的函数是一致的。在数学中，函数的引入极大简化了表达。重复的运算可以由函数或函数的组合来表达，同时我们也可以对函数本身进行进一步的研究（比如导数）。程序中也是同理。程序的开发是为了解决人类的重复性工作，其代码过程中也必然会有大量重复的，需要复用的地方。而函数就为这种场景提供了绝佳的解决方案。

但程序中的函数和数学上的函数还存在一定差异。对于一个数学函数，对于一个给定的 $$ x $$，无论传入多少次，其结果都是不变的。但这一行为在大多数编程语言中通常是不被保证的，即这一函数函数是不是纯函数 (pure function)。我们会在之后的例子中进一步讨论这一问题。

~~当我们把需求、比萨和咖啡扔给程序员，程序员就会输出程序。~~

~~从这个角度上来看，程序员不也是一个函数吗？~~

## 函数定义

函数的三大要素：定义域、值域和映射方法。对应到程序中就是参数、返回值和代码块。我们也从这三块来理解 Ruby 中的函数定义。

```ruby
def succ(x)
  x += 1
end
```

### 豆知识：`void` or `nil`?

在 Ruby 中任何方法都有「返回值」，但返回值可能为「空」。这句话听起来非常拗口，我们来简单比较一下。如果我们在 C++ 语言中定义一个函数如下：

```cpp
void void_function() {
  return;
}

int main() {
  auto x = void_function(); // illegal, 非法代码。
  return 0;
}
```

这段代码是非法的，因为 `void_function()` 没有返回值，不能让其结果赋值给 `x`。

### 豆知识：定义好的函数可以取消吗？

虽然这件事比较不可能

```ruby
def foo
  'bar'
end

undef foo

foo # => NameError
```
